<!DOCTYPE html>
<html>
<head>
    <title>Research Study</title>

    <!--
        Written by Jay Son (minimum viable product) & Jae-Young Son (expansion)
    -->

    <!-- Utilities -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="utils/jquery.csv.js"></script>
    <script src="utils/utils.js"></script>
    <!-- jsPsych -->
    <script src="jspsych-6.2.0/jspsych.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-instructions.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-image-keyboard-response.js"></script>
    <link href="jspsych-6.2.0/css/jspsych.css" rel="stylesheet" type="text/css">
    <!-- Helpers -->
    <script src="resources/adj.js"></script>
    <script src="resources/imgs.js"></script>
    <script src="resources/setup.js"></script>
    <script src="resources/learn.js"></script>

    <style>
        .flex-container {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .item {
            margin: 5px;
        }
    </style>

</head>
<body></body>

<script>

    /* Create timeline */
    var timeline = [];

    /* Template: fixation */
    var fixation = {
        type: 'html-keyboard-response',
        stimulus: '<div style="font-size:60px;">+</div>',
        choices: jsPsych.NO_KEYS,
        trial_duration: function() {
            return get_uniform(250, 750);
        },
        data: { feature: 'fixation' }
    }

    /* Template: ready-set-go */
    var get_ready = {
        type: 'html-keyboard-response',
        timeline: [
            {
                stimulus: 'To get ready, place your index fingers on the F and J keys. <p> Please press F.',
                choices: ['f']
            },
            {
                stimulus: 'To begin, please press J.',
                choices: ['j']
            }
        ]
    }

    /* Learning task */
    var learn_instruct = {
        type: 'instructions',
        pages: [
            // slide 1
            "<p> In this part of the study, you will see two people from the same college on each trial. " +
                "<br> Your job is to learn whether those two people are friends with each other." +
                "<br> After making a guess, you'll see feedback indicating whether they're actually friends. </p>" +
            "<p> At first, you might feel like you're guessing randomly. That's okay. " +
                "<br> Just try your best to learn who's friends with each other. </p>" +
            "<p> You'll see each pair of people three times (in three separate 'runs' of the task). " +
                "<br> In each run, try to improve how accurately you can remember who's friends with each other. </p>",

            // slide 2
            "<p> Please note that you will earn an additional bonus, depending on how accurately " +
                "<br> you're able to learn who's friends with each other. </p>" +
            "<p> This is a pretty hard task, so don't feel too discouraged if you feel like " +
                "<br> you're not doing very well. Just try your best to learn who's friends. </p>",

            // slide 3
            "<p> You will use the F and J keys to respond." +
                "<br> F = 'Not Friends'" +
                "<br> J = 'Yes Friends' </p>"
        ],
        show_clickable_nav: true,
        allow_keys: false
    }
    timeline.push(learn_instruct);
    timeline.push(get_ready);

    // For narrative clarity, many helpers are tucked away in resources/learn_mem.js
    var learn_procedure = {
        timeline: [
            fixation,
            learn_guess,
            learn_resp_f,
            learn_resp_j,
            learn_feedback
        ],
        timeline_variables: learn_prompts,
        randomize_order: true
    }
    timeline.push(learn_procedure);

    // TODO:
    //  Write break screens between learning runs
    //  Write memory task (slight modification of allowable keys)
    //  Write message-passing task (more flexbox agony ahead)

    /* Start the experiment */
    jsPsych.init({
        timeline: timeline,
        on_finish: function () {
            jsPsych.data.displayData();
        }
    });

</script>

</html>